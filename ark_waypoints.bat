@echo off
setlocal enabledelayedexpansion

:: --- Configuration ---
set "INI_FILENAME=GameUserSettings.ini"
set "STEAM_PATH="
set "CONFIG_SUBPATH=\steamapps\common\ARK Survival Ascended\ShooterGame\Saved\Config\Windows"
set "TARGET_SECTION=[/Script/ShooterGame.ShooterGameUserSettings]"
set "TEMP_INI_FILENAME=%~n0_temp.ini"
set "BACKUP_FILENAME=%INI_FILENAME%.bak"

echo.
echo ======================================================================
echo ðŸ—ºï¸ ARK: Survival Ascended - Scorched Earth Waypoint Installer
echo ======================================================================
echo This script will add all Explorer Notes and Dossiers waypoints to
echo your map by modifying the "%INI_FILENAME%" file.
echo.
echo Please ensure ARK: Survival Ascended is NOT running before proceeding.
echo.

:: --- Prompt for Steam Directory ---
:get_steam_path
echo Please enter the FULL path to your Steam installation folder (e.g., C:\Program Files (x86)\Steam):
set /p "STEAM_PATH=> "
echo.

:: Remove surrounding quotes if the user added them
set "STEAM_PATH=!STEAM_PATH:"=!"

:: Construct full config path
set "CONFIG_PATH=%STEAM_PATH%%CONFIG_SUBPATH%"

:: Validate if the file exists
if not exist "%CONFIG_PATH%\%INI_FILENAME%" (
    echo âŒ ERROR: The file "%CONFIG_PATH%\%INI_FILENAME%" was not found.
    echo Please check the Steam path you entered and try again.
    echo The full expected path is:
    echo "%CONFIG_PATH%\%INI_FILENAME%"
    echo.
    goto get_steam_path
)

echo âœ… Found configuration file at:
echo "%CONFIG_PATH%\%INI_FILENAME%"
echo.

:: --- Create Backup ---
echo ðŸ’¾ Creating a backup of "%INI_FILENAME%" to "%BACKUP_FILENAME%"...
copy "%CONFIG_PATH%\%INI_FILENAME%" "%CONFIG_PATH%\%BACKUP_FILENAME%" >nul
if exist "%CONFIG_PATH%\%BACKUP_FILENAME%" (
    echo âœ… Backup created successfully.
) else (
    echo âŒ ERROR: Failed to create backup. Aborting.
    pause
    exit /b 1
)
echo.

:: --- Waypoint Data to Insert ---
(
    echo SavedMinimapMarks=(Name="bob1",CustomTag="1",Location=(X=-95345.000000,Y=190144.000000,Z=-20536.000000),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=True,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob2",CustomTag="2",Location=(X=-278127.745790,Y=77926.139677,Z=-32265.609807),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob3",CustomTag="3",Location=(X=-103663.297423,Y=188724.453762,Z=-10429.362887),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob4",CustomTag="4",Location=(X=-279905.630754,Y=265035.554098,Z=-11876.792374),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob5",CustomTag="5",Location=(X=-206248.800000,Y=-240894.400000,Z=10380.414621),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob6",CustomTag="6",Location=(X=-153666.653858,Y=-79830.086796,Z=29252.115453),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob7",CustomTag="7",Location=(X=-31464.942452,Y=48134.547284,Z=4993.427645),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob8",CustomTag="8",Location=(X=130569.570053,Y=152897.444278,Z=-13440.048279),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob9",CustomTag="9",Location=(X=226305.408020,Y=211766.087257,Z=-11463.363866),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="bob10",CustomTag="10",Location=(X=-123363.738666,Y=33735.100985,Z=1280.099197),Color=(R=1.000000,G=1.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_Missions_MultiplayerOptionalIcon.T_UI_Missions_MultiplayerOptionalIcon"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Oasisaur",CustomTag="11",Location=(X=-274181.000000,Y=76736.000000,Z=-32733.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=True,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Thorny",CustomTag="12",Location=(X=-286006.000000,Y=249354.000000,Z=-8832.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Phoenix",CustomTag="13",Location=(X=-283047.000000,Y=277777.000000,Z=-11089.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Jerboa",CustomTag="14",Location=(X=-301460.000000,Y=-104695.000000,Z=-15905.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Moth",CustomTag="15",Location=(X=-139135.000000,Y=120189.000000,Z=-7835.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Fasolusuchus",CustomTag="16",Location=(X=-96525.000000,Y=181630.000000,Z=-21379.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Rock",CustomTag="17",Location=(X=-140106.000000,Y=235925.000000,Z=-13157.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Morellatops",CustomTag="18",Location=(X=16743.000000,Y=264470.000000,Z=-13483.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Jug",CustomTag="19",Location=(X=77700.000000,Y=-119534.000000,Z=-10555.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Mantis",CustomTag="20",Location=(X=273716.000000,Y=-255616.000000,Z=-10737.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Vulture",CustomTag="21",Location=(X=138632.400000,Y=-254280.200000,Z=-11358.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Wyvern",CustomTag="22",Location=(X=-29740.000000,Y=-303517.000000,Z=-12093.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Deathworm",CustomTag="23",Location=(X=-29984.000000,Y=-250872.000000,Z=-15803.000000),Color=(R=1.000000,G=0.000000,B=0.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Tame.T_UI_HUDPointOfInterest_Tame"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena1",CustomTag="24",Location=(X=-39320.000000,Y=-54280.600000,Z=-13957.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena2",CustomTag="25",Location=(X=168659.000000,Y=-9385.000000,Z=-10054.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena3",CustomTag="26",Location=(X=208422.000000,Y=55952.000000,Z=-3823.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena4",CustomTag="27",Location=(X=110837.000000,Y=252735.000000,Z=-2421.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena5",CustomTag="28",Location=(X=32254.000000,Y=-74357.000000,Z=-19081.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena6",CustomTag="29",Location=(X=-199194.000000,Y=6681.000000,Z=-17667.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena7",CustomTag="30",Location=(X=-166200.000000,Y=-144475.000000,Z=10309.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena8",CustomTag="31",Location=(X=18505.000000,Y=-213994.000000,Z=-13150.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena9",CustomTag="32",Location=(X=294609.000000,Y=7762.000000,Z=-8546.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena10",CustomTag="33",Location=(X=203942.000000,Y=216943.000000,Z=-13377.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena11",CustomTag="34",Location=(X=-262975.000000,Y=-311422.000000,Z=-7993.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena12",CustomTag="35",Location=(X=-230113.000000,Y=-268516.000000,Z=-12672.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena13",CustomTag="36",Location=(X=-299111.000000,Y=-209870.000000,Z=-11502.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena14",CustomTag="37",Location=(X=-79337.000000,Y=-273700.000000,Z=-8653.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena15",CustomTag="38",Location=(X=-119010.000000,Y=-287322.000000,Z=-11393.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena16",CustomTag="39",Location=(X=52935.000000,Y=-267573.000000,Z=-14822.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena17",CustomTag="40",Location=(X=18855.000000,Y=-210514.000000,Z=-18147.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena18",CustomTag="41",Location=(X=129521.000000,Y=-317103.000000,Z=-12752.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena19",CustomTag="42",Location=(X=-187699.000000,Y=23511.000000,Z=-13379.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena20",CustomTag="43",Location=(X=-10922.000000,Y=38906.000000,Z=-8726.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena21",CustomTag="44",Location=(X=-287365.000000,Y=286690.000000,Z=-8797.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena22",CustomTag="45",Location=(X=-250252.000000,Y=296919.000000,Z=-13850.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena23",CustomTag="46",Location=(X=-82424.000000,Y=127532.000000,Z=-11849.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena24",CustomTag="47",Location=(X=165230.000000,Y=81729.000000,Z=-13340.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena25",CustomTag="48",Location=(X=166786.000000,Y=179229.000000,Z=-19412.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena26",CustomTag="49",Location=(X=-103083.000000,Y=275746.000000,Z=-15616.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena27",CustomTag="50",Location=(X=-294175.000000,Y=39110.000000,Z=-15465.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=232,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena28",CustomTag="51",Location=(X=-120958.000000,Y=-262028.000000,Z=-13373.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena29",CustomTag="52",Location=(X=-55276.000000,Y=-222134.000000,Z=-10067.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Helena30",CustomTag="53",Location=(X=-9740.000000,Y=-211448.000000,Z=-9748.000000),Color=(R=0.985410,G=0.241582,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Location.T_UI_HUDPointOfInterest_Location"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia1",CustomTag="54",Location=(X=-81694.000000,Y=-313251.000000,Z=-9694.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia2",CustomTag="55",Location=(X=-4857.000000,Y=11562.000000,Z=-19525.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia3",CustomTag="56",Location=(X=6460.000000,Y=-6538.000000,Z=-17044.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia4",CustomTag="57",Location=(X=146560.000000,Y=285403.000000,Z=-16203.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia5",CustomTag="58",Location=(X=74421.000000,Y=158504.000000,Z=-15659.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia6",CustomTag="59",Location=(X=87554.000000,Y=-220858.000000,Z=-9673.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia7",CustomTag="60",Location=(X=209058.000000,Y=226082.000000,Z=-19846.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia8",CustomTag="61",Location=(X=52577.000000,Y=-265598.000000,Z=-15120.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia9",CustomTag="62",Location=(X=241889.000000,Y=2695.000000,Z=-6770.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia10",CustomTag="63",Location=(X=-91148.000000,Y=309710.000000,Z=-11964.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia11",CustomTag="64",Location=(X=153451.000000,Y=214069.000000,Z=-19216.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia12",CustomTag="65",Location=(X=82472.000000,Y=208465.000000,Z=-13906.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia13",CustomTag="66",Location=(X=214260.000000,Y=215027.000000,Z=-12452.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia14",CustomTag="67",Location=(X=286261.000000,Y=-142520.000000,Z=-16961.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia15",CustomTag="68",Location=(X=305136.000000,Y=-193301.000000,Z=-7003.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
    echo SavedMinimapMarks=(Name="Raia16",CustomTag="69",Location=(X=-322717.000000,Y=-25092.000000,Z=-13103.000000),Color=(R=0.000000,G=0.419717,B=1.000000,A=1.000000),ID=0,MarkIcon=/Script/Engine.Texture2D'"/Game/PrimalEarth/UI/Textures/T_UI_HUDPointOfInterest_Collectible.T_UI_HUDPointOfInterest_Collectible"',MapName="ScorchedEarth_WP",bIsShowing=False,IconColor=(R=1.000000,G=1.000000,B=1.000000,A=1.000000),bIsShowingText=True,CharacterID=-1,CharacterIsPlayer=False)
) > "%TEMP_INI_FILENAME%"

:: --- File Modification Logic ---
echo ðŸ“ Inserting waypoints into "%INI_FILENAME%"...
(
    for /f "tokens=*" %%a in ('type "%CONFIG_PATH%\%INI_FILENAME%"') do (
        echo.%%a
        if "%%a" == "%TARGET_SECTION%" (
            echo.
            type "%TEMP_INI_FILENAME%"
            echo.
        )
    )
) > "%CONFIG_PATH%\%INI_FILENAME%.new"

:: Replace original with new file
move /Y "%CONFIG_PATH%\%INI_FILENAME%.new" "%CONFIG_PATH%\%INI_FILENAME%" >nul

:: Cleanup temporary file
del "%TEMP_INI_FILENAME%" 2>nul

echo.
echo ======================================================================
echo ðŸŽ‰ **Installation Complete!**
echo The Scorched Earth waypoints have been added to your map file.
echo.
echo **Next Steps:**
echo 1. Start ARK: Survival Ascended.
echo 2. Load into your Scorched Earth game.
echo 3. The waypoints should now appear on your map (M key).
echo.
echo If you have any issues, your original file was backed up as "%BACKUP_FILENAME%"
echo in the same folder.
echo ======================================================================
pause
endlocal